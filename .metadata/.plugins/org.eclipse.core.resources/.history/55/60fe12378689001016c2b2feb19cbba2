<%@ page contentType="text/html; charset=UTF-8" language="java" %>
<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8">
  <title>Vas ljubimac</title>
  <style>
    body{font-family:system-ui,Arial,sans-serif;margin:0;background:#f7f9fb;color:#1a1a1a}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px;
           padding:16px 24px;background:#fff;border-bottom:1px solid #e6e6e6}
    header img{height:56px}
    nav a{margin-right:14px;text-decoration:none;color:#0b5ed7}
    .hero{display:flex;align-items:center;justify-content:space-between;gap:24px;padding:40px 24px}
    .hero h1{margin:0 0 8px 0}
    .card{background:#fff;border:1px solid #e6e6e6;border-radius:12px;padding:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;padding:0 24px 32px}
    .btn{display:inline-block;background:#0b5ed7;color:#fff;padding:10px 16px;border-radius:8px;text-decoration:none}
  </style>
</head>
<body>
<header>
  <!-- logo + naziv -->
  <div style="display:flex;align-items:center;gap:16px;">
    <img src="/img/logo.png" alt="Logo">
    <div style="font-weight:700">Veterinarska stanica Vaš ljubimac</div>
  </div>

  <!-- navigacija -->
  <nav>
    <a href="/ljubimci">Ljubimci</a>
    <a href="/pregledi">Pregledi</a>
    <a href="/poruke">Poruke</a>
    <a id="navIzvestaji" href="/izvestaji" style="display:none">Izveštaji</a>
    <a href="/prijava">Prijava</a>
    <a href = "/registracija">Registracija</a>
  </nav>

  <!-- user info i odjava -->
  <div id="userBox" style="margin-left:auto;">
    <span id="userInfo"></span>
    <button id="btnLogout" style="margin-left:12px;display:none;">Odjava</button>
  </div>
</header>

<section class="hero">
  <div>
    <h1>Dobrodošli 🐾</h1>
    <p>Upravljanje ljubimcima, zakazivanje pregleda i izveštaji — na jednom mestu.</p>
    <a class="btn" href="/ljubimci">Započni</a>
  </div>
  <div class="card">
    <img src="/img/logo.png" alt="Ljubimci" style="height:140px;display:block;margin:auto">
  </div>
</section>

<section class="grid">
  <div class="card"><h3>😊 Ljubimci</h3><p>Dodaj i uređuj ljubimce.</p></div>
  <div class="card"><h3>📅 Pregledi</h3><p>Zakaži i izmeni termine.</p></div>
  <div class="card"><h3>💬 Poruke</h3><p>Razmena poruka sa veterinarom.</p></div>
</section>

<!-- auth helpers -->
<script src="/js/auth.js"></script>
<script>showAdminMenu();</script>

<script>
(function() {
  function paintUserBox() {
    var info = document.getElementById('userInfo');
    var btn  = document.getElementById('btnLogout');
    if (!info || !btn) return;

    var token = localStorage.getItem('jwt');
    if (token) {
      var roles = [];
      try { roles = JSON.parse(localStorage.getItem('roles') || "[]"); } catch(e){}
      var txt = roles.length
        ? "Prijavljen (" + roles.map(r => (r.authority || r)).join(", ") + ")"
        : "Prijavljen";
      info.textContent = txt;
      btn.style.display = 'inline-block';
      btn.onclick = function(){ logout(); location.href='/'; };
    } else {
      info.innerHTML = '<a href="/prijava">Prijavi se</a>';
      btn.style.display = 'none';
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', paintUserBox);
  } else {
    paintUserBox();
  }
})();
</script>
</body>
</html>
