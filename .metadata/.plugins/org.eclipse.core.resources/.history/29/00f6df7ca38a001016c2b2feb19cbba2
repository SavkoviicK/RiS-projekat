package com.veterinarska.stanica.repository;

import com.veterinarska.stanica.model.Prijateljstvo;
import com.veterinarska.stanica.model.Korisnik;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import java.util.List;

public interface PrijateljstvoRepository extends JpaRepository<Prijateljstvo, Long> {

    @Query("""
      select count(p) > 0 from Prijateljstvo p
      where (p.korisnik1.id = :a and p.korisnik2.id = :b)
         or (p.korisnik1.id = :b and p.korisnik2.id = :a)
    """)
    boolean jesuPrijatelji(long a, long b);

    @Query("""
      select case when p.korisnik1.id = :userId then p.korisnik2 else p.korisnik1 end
      from Prijateljstvo p
      where p.korisnik1.id = :userId or p.korisnik2.id = :userId
    """)
    List<Korisnik> listaPrijatelja(long userId);
}
