package com.veterinarska.stanica.repository;

import com.veterinarska.stanica.model.Friendship;
import com.veterinarska.stanica.model.Korisnik;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.Query;

import java.util.List;

public interface FriendshipRepository extends JpaRepository<Friendship, Long> {

    @Query("""
      select count(f) > 0 from Friendship f
      where (f.user1.id = :a and f.user2.id = :b)
         or (f.user1.id = :b and f.user2.id = :a)
    """)
    boolean areFriends(long a, long b);

    @Query("""
      select case when f.user1.id = :userId then f.user2 else f.user1 end
      from Friendship f
      where f.user1.id = :userId or f.user2.id = :userId
    """)
    List<Korisnik> listFriends(long userId);
}
